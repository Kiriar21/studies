w0=[0,917.338];
w1=[0.0526316,919.094];
w2=[0.105263,933.115];
w3=[0.157895,883.17];
w4=[0.210526,898.498];
w5=[0.263158,1038.56];

w6=[0.263158,1038.56];
w7=[0.315789,858.575];
w8=[0.368421,743.424];
w9=[0.421053,1182.35];
w10=[0.473684,1010.79];
w11=[0.526316,453.202];

w12=[0.526316,453.202];
w13=[0.578947,1162.94];
w14=[0.631579,1431.95];
w15=[0.684211,227.166];
w16=[0.736842,769.188];
w17=[0.789474,1992.95];

w18=[0.789474,1992.95];
w19=[0.842105,386.341];
w20=[0.894737,-21.5433];
w21=[0.947368,2327.38];
w22=[0.9999,1165.1];
w23=[1,1165.1];
function interp(w0,w1,w2,w3,w4,w5)

w = [w0;w1;w2;w3;w4;w5];

fi = zeros(1,6);
fi(1) = (w(1,1)-w(2,1))*(w(1,1)-w(3,1))*(w(1,1)-w(4,1))*(w(1,1)-w(5,1))*(w(1,1)-w(6,1));
fi(2) = (w(2,1)-w(1,1))*(w(2,1)-w(3,1))*(w(2,1)-w(4,1))*(w(2,1)-w(5,1))*(w(2,1)-w(6,1));
fi(3) = (w(3,1)-w(2,1))*(w(3,1)-w(1,1))*(w(3,1)-w(4,1))*(w(3,1)-w(5,1))*(w(3,1)-w(6,1));
fi(4) = (w(4,1)-w(2,1))*(w(4,1)-w(1,1))*(w(4,1)-w(3,1))*(w(4,1)-w(5,1))*(w(4,1)-w(6,1));
fi(5) = (w(5,1)-w(2,1))*(w(5,1)-w(1,1))*(w(5,1)-w(4,1))*(w(5,1)-w(3,1))*(w(5,1)-w(6,1));
fi(6) = (w(6,1)-w(2,1))*(w(6,1)-w(1,1))*(w(6,1)-w(4,1))*(w(6,1)-w(5,1))*(w(6,1)-w(3,1));

a = zeros(1,6);
for i = 1:6
  a(i) = w(i,2) / fi(i);
endfor

wsp = zeros(1,6);

% (a*(x-m)*(x-n)*(x-o)*(x-p)*(x-r) = ax^5 - (am+an+ao+ap+ar)x^4 + (amn+amo+amp+amr+ano+anp+anr+aop+aor+apr)x^3 - (amno+amnp+amnr+amop+amor+ampr+anop+anor+anpr+aopr)x^2 + (amnop+amnor+amnpr+amopr+anopr)x - amnopr)
wsp(1) = -(a(1)*w(2,1)*w(3,1)*w(4,1)*w(5,1)*w(6,1)+a(2)*w(1,1)*w(3,1)*w(4,1)*w(5,1)*w(6,1)+a(3)*w(1,1)*w(2,1)*w(4,1)*w(5,1)*w(6,1)+a(4)*w(1,1)*w(3,1)*w(2,1)*w(5,1)*w(6,1)+a(5)*w(1,1)*w(3,1)*w(4,1)*w(2,1)*w(6,1)+a(6)*w(1,1)*w(3,1)*w(4,1)*w(5,1)*w(2,1));
wsp(2)= a(1)*w(2,1)*w(3,1)*w(4,1)*w(5,1)+a(1)*w(2,1)*w(3,1)*w(4,1)*w(6,1)+a(1)*w(2,1)*w(3,1)*w(5,1)*w(6,1)+a(1)*w(2,1)*w(4,1)*w(5,1)*w(6,1)+a(1)*w(3,1)*w(4,1)*w(5,1)*w(6,1)+a(2)*w(1,1)*w(3,1)*w(4,1)*w(5,1)+a(2)*w(1,1)*w(3,1)*w(4,1)*w(6,1)+a(2)*w(1,1)*w(3,1)*w(5,1)*w(6,1)+a(2)*w(1,1)*w(4,1)*w(5,1)*w(6,1)+a(2)*w(3,1)*w(4,1)*w(5,1)*w(6,1)+a(3)*w(2,1)*w(1,1)*w(4,1)*w(5,1)+a(3)*w(2,1)*w(1,1)*w(4,1)*w(6,1)+a(3)*w(2,1)*w(1,1)*w(5,1)*w(6,1)+a(3)*w(2,1)*w(4,1)*w(5,1)*w(6,1)+a(3)*w(1,1)*w(4,1)*w(5,1)*w(6,1)+a(4)*w(2,1)*w(3,1)*w(1,1)*w(5,1)+a(4)*w(2,1)*w(3,1)*w(1,1)*w(6,1)+a(4)*w(2,1)*w(3,1)*w(5,1)*w(6,1)+a(4)*w(2,1)*w(1,1)*w(5,1)*w(6,1)+a(4)*w(3,1)*w(1,1)*w(5,1)*w(6,1)+a(5)*w(2,1)*w(3,1)*w(4,1)*w(1,1)+a(5)*w(2,1)*w(3,1)*w(4,1)*w(6,1)+a(5)*w(2,1)*w(3,1)*w(1,1)*w(6,1)+a(5)*w(2,1)*w(4,1)*w(1,1)*w(6,1)+a(5)*w(3,1)*w(4,1)*w(1,1)*w(6,1)+a(6)*w(2,1)*w(3,1)*w(4,1)*w(5,1)+a(6)*w(2,1)*w(3,1)*w(4,1)*w(1,1)+a(6)*w(2,1)*w(3,1)*w(5,1)*w(1,1)+a(6)*w(2,1)*w(4,1)*w(5,1)*w(1,1)+a(6)*w(3,1)*w(4,1)*w(5,1)*w(1,1);
wsp(3) = -(a(1)*w(2,1)*w(3,1)*w(4,1)+a(1)*w(2,1)*w(3,1)*w(5,1)+a(1)*w(2,1)*w(3,1)*w(6,1)+a(1)*w(2,1)*w(4,1)*w(5,1)+a(1)*w(2,1)*w(4,1)*w(6,1)+a(1)*w(2,1)*w(5,1)*w(6,1)+a(1)*w(3,1)*w(4,1)*w(5,1)+a(1)*w(3,1)*w(4,1)*w(6,1)+a(1)*w(3,1)*w(5,1)*w(6,1)+a(1)*w(4,1)*w(5,1)*w(6,1)) -  (a(2)*w(1,1)*w(3,1)*w(4,1)+a(2)*w(1,1)*w(3,1)*w(5,1)+a(2)*w(1,1)*w(3,1)*w(6,1)+a(2)*w(1,1)*w(4,1)*w(5,1)+a(2)*w(1,1)*w(4,1)*w(6,1)+a(2)*w(1,1)*w(5,1)*w(6,1)+a(2)*w(3,1)*w(4,1)*w(5,1)+a(2)*w(3,1)*w(4,1)*w(6,1)+a(2)*w(3,1)*w(5,1)*w(6,1)+a(2)*w(4,1)*w(5,1)*w(6,1)) - (a(3)*w(2,1)*w(1,1)*w(4,1)+a(3)*w(2,1)*w(1,1)*w(5,1)+a(3)*w(2,1)*w(1,1)*w(6,1)+a(3)*w(2,1)*w(4,1)*w(5,1)+a(3)*w(2,1)*w(4,1)*w(6,1)+a(3)*w(2,1)*w(5,1)*w(6,1)+a(3)*w(1,1)*w(4,1)*w(5,1)+a(3)*w(1,1)*w(4,1)*w(6,1)+a(3)*w(1,1)*w(5,1)*w(6,1)+a(3)*w(4,1)*w(5,1)*w(6,1))-(a(4)*w(2,1)*w(3,1)*w(1,1)+a(4)*w(2,1)*w(3,1)*w(5,1)+a(4)*w(2,1)*w(3,1)*w(6,1)+a(4)*w(2,1)*w(1,1)*w(5,1)+a(4)*w(2,1)*w(1,1)*w(6,1)+a(4)*w(2,1)*w(5,1)*w(6,1)+a(4)*w(3,1)*w(1,1)*w(5,1)+a(4)*w(3,1)*w(1,1)*w(6,1)+a(4)*w(3,1)*w(5,1)*w(6,1)+a(4)*w(1,1)*w(5,1)*w(6,1))-(a(5)*w(2,1)*w(3,1)*w(4,1)+a(5)*w(2,1)*w(3,1)*w(1,1)+a(5)*w(2,1)*w(3,1)*w(6,1)+a(5)*w(2,1)*w(4,1)*w(1,1)+a(5)*w(2,1)*w(4,1)*w(6,1)+a(5)*w(2,1)*w(1,1)*w(6,1)+a(5)*w(3,1)*w(4,1)*w(1,1)+a(5)*w(3,1)*w(4,1)*w(6,1)+a(5)*w(3,1)*w(1,1)*w(6,1)+a(5)*w(4,1)*w(1,1)*w(6,1))-(a(6)*w(2,1)*w(3,1)*w(4,1)+a(6)*w(2,1)*w(3,1)*w(5,1)+a(6)*w(2,1)*w(3,1)*w(1,1)+a(6)*w(2,1)*w(4,1)*w(5,1)+a(6)*w(2,1)*w(4,1)*w(1,1)+a(6)*w(2,1)*w(5,1)*w(1,1)+a(6)*w(3,1)*w(4,1)*w(5,1)+a(6)*w(3,1)*w(4,1)*w(1,1)+a(6)*w(3,1)*w(5,1)*w(1,1)+a(6)*w(4,1)*w(5,1)*w(1,1));
wsp(4) = (a(1)*w(2,1)*w(3,1)+a(1)*w(2,1)*w(4,1)+a(1)*w(2,1)*w(5,1)+a(1)*w(2,1)*w(6,1)+a(1)*w(3,1)*w(4,1)+a(1)*w(3,1)*w(5,1)+a(1)*w(3,1)*w(6,1)+a(1)*w(4,1)*w(5,1)+a(1)*w(4,1)*w(6,1)+a(1)*w(5,1)*w(6,1))+(a(2)*w(1,1)*w(3,1)+a(2)*w(1,1)*w(4,1)+a(2)*w(1,1)*w(5,1)+a(2)*w(1,1)*w(6,1)+a(2)*w(3,1)*w(4,1)+a(2)*w(3,1)*w(5,1)+a(2)*w(3,1)*w(6,1)+a(2)*w(4,1)*w(5,1)+a(2)*w(4,1)*w(6,1)+a(2)*w(5,1)*w(6,1))+(a(3)*w(2,1)*w(1,1)+a(3)*w(2,1)*w(4,1)+a(3)*w(2,1)*w(5,1)+a(3)*w(2,1)*w(6,1)+a(3)*w(1,1)*w(4,1)+a(3)*w(1,1)*w(5,1)+a(3)*w(1,1)*w(6,1)+a(3)*w(4,1)*w(5,1)+a(3)*w(4,1)*w(6,1)+a(3)*w(5,1)*w(6,1))+(a(4)*w(2,1)*w(3,1)+a(4)*w(2,1)*w(1,1)+a(4)*w(2,1)*w(5,1)+a(4)*w(2,1)*w(6,1)+a(4)*w(3,1)*w(1,1)+a(4)*w(3,1)*w(5,1)+a(4)*w(3,1)*w(6,1)+a(4)*w(1,1)*w(5,1)+a(4)*w(1,1)*w(6,1)+a(4)*w(5,1)*w(6,1))+(a(5)*w(2,1)*w(3,1)+a(5)*w(2,1)*w(4,1)+a(5)*w(2,1)*w(1,1)+a(5)*w(2,1)*w(6,1)+a(5)*w(3,1)*w(4,1)+a(5)*w(3,1)*w(1,1)+a(5)*w(3,1)*w(6,1)+a(5)*w(4,1)*w(1,1)+a(5)*w(4,1)*w(6,1)+a(5)*w(1,1)*w(6,1))+(a(6)*w(2,1)*w(3,1)+a(6)*w(2,1)*w(4,1)+a(6)*w(2,1)*w(5,1)+a(6)*w(2,1)*w(1,1)+a(6)*w(3,1)*w(4,1)+a(6)*w(3,1)*w(5,1)+a(6)*w(3,1)*w(1,1)+a(6)*w(4,1)*w(5,1)+a(6)*w(4,1)*w(1,1)+a(6)*w(5,1)*w(1,1));  
wsp(5) = -(a(1)*w(2,1)+a(1)*w(3,1)+a(1)*w(4,1)+a(1)*w(5,1)+a(1)*w(6,1))-(a(2)*w(1,1)+a(2)*w(3,1)+a(2)*w(4,1)+a(2)*w(5,1)+a(2)*w(6,1))-(a(3)*w(2,1)+a(3)*w(1,1)+a(3)*w(4,1)+a(3)*w(5,1)+a(3)*w(6,1))-(a(4)*w(2,1)+a(4)*w(3,1)+a(4)*w(1,1)+a(4)*w(5,1)+a(4)*w(6,1))-(a(5)*w(2,1)+a(5)*w(3,1)+a(5)*w(4,1)+a(5)*w(1,1)+a(5)*w(6,1))-(a(6)*w(2,1)+a(6)*w(3,1)+a(6)*w(4,1)+a(6)*w(5,1)+a(6)*w(1,1));
wsp(6) = (a(1)+a(2)+a(3)+a(4)+a(5)+a(6));
fprintf("W(x) = %f*x^5 + %f*x^4 + %f*x^3 + %f*x^2 + %f*x + %f\n", wsp(6),wsp(5),wsp(4), wsp(3),wsp(2),wsp(1));

x = [w(1,1),w(2,1)-((w(2,1)-w(1,1))/2),w(2,1),w(3,1)-((w(3,1)-w(2,1))/2),w(3,1),w(4,1)-((w(4,1)-w(3,1))/2),w(4,1),w(5,1)-((w(5,1)-w(4,1))/2),w(5,1),w(6,1)-((w(6,1)-w(5,1))/2),w(6,1)];
y = zeros(1,11);


for i=1:11
  fi(1) = (x(i)-w(2,1))*(x(i)-w(3,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(2) = (x(i)-w(1,1))*(x(i)-w(3,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(3) = (x(i)-w(2,1))*(x(i)-w(1,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(4) = (x(i)-w(2,1))*(x(i)-w(1,1))*(x(i)-w(3,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(5) = (x(i)-w(2,1))*(x(i)-w(1,1))*(x(i)-w(4,1))*(x(i)-w(3,1))*(x(i)-w(6,1));
  fi(6) = (x(i)-w(2,1))*(x(i)-w(1,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(3,1));
  y(i) = a(1)*fi(1) + a(2)*fi(2) + a(3)*fi(3) + a(4)*fi(4) + a(5)*fi(5) + a(6)*fi(6);
endfor
plot(x,y);
grid on;
hold on;

vector_x=[w(1,1),w(2,1),w(3,1),w(4,1),w(5,1),w(6,1)];
vector_y=[0,0,0,0,0,0];
for i=1:6
  for j=1:6
    vector_y(1,j) = vector_y(1,j)+wsp(i)*w(j,1)^(i-1);
  endfor
endfor
plot(vector_x,vector_y,'rx'); 


for i=1:6
  plot(w(i,1),w(i,2),'--gs');
endfor
title("Interpolacja Lagrange'a - wykres");
ylabel("Os y");
xlabel("Os x");
endfunction
interp(w0,w1,w2,w3,w4,w5);
interp(w6,w7,w8,w9,w10,w11);
interp(w12,w13,w14,w15,w16,w17);
interp(w18,w19,w20,w21,w22,w23);
